doctype html
head
    title #{title}
    style.
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font: 13px Helvetica, Arial; }
        div { background: #000; padding: 3px; position: fixed; bottom: 0; width: 100%; }
        div input { border: 0; padding: 10px; width: 90%; margin-right: .5%; }
        div button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 10px; }
        #messages { list-style-type: none; margin: 0; padding: 0; }
        #messages li { padding: 5px 10px; }
        #messages li:nth-child(odd) { background: #eee; }
input(type="hidden", value=user.username, id="username")
input(type="text", value=user.username, id="create_room")
button#create create
br
select(id="join_room")
button#join join

ul#messages
div(action='')
    input#m(autocomplete='off')
    button#submit Send
script(src='/socket.io/socket.io.js')
script.
    var socket = io.connect('http://localhost:3000');
    document.getElementById('submit').addEventListener("click", function () {
        let messageBox = document.getElementById('m');
        let username = document.getElementById("username").value;
        let room = document.getElementById('join_room').value;
        socket.emit('chat message', {sender: username, msg: messageBox.value, room: room});
        messageBox.value = "";
        return false;
    });
    document.getElementById('create').addEventListener("click", function () {
        let room = document.getElementById('create_room').value;
        socket.emit('create room', {room: room});
        return false;
    });
    document.getElementById('join').addEventListener("click", function () {
        let room = document.getElementById('join_room').value;
        console.log(room);
        socket.emit('join room', {room: room});
        return false;
    });
    socket.on('chat message', function (msg) {
        let data = document.createElement("li");
        data.innerText = msg.sender + ": " + msg.msg;
        document.getElementById('messages').append(data);
    });
    socket.on('room', function (rooms) {
        console.log(rooms);
        const keys = Object.keys(rooms);
        document.getElementById('join_room').innerHTML = "";
        for (let i = 0; i < keys.length; i++) {
            let data = document.createElement("option");
            data.innerText = keys[i];
            data.value = keys[i];
            document.getElementById('join_room').append(data);
        }

    });